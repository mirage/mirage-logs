<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mirage_logs_cli (mirage-logs.Mirage_logs_cli)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">mirage-logs</a> &#x00BB; Mirage_logs_cli</nav><header class="odoc-preamble"><h1>Module <code><span>Mirage_logs_cli</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#log-thresholds">Log Thresholds</a></li></ul></nav><div class="odoc-content"><h3 id="log-thresholds"><a href="#log-thresholds" class="anchor"></a>Log Thresholds</h3><div class="odoc-spec"><div class="spec type anchored" id="type-threshold"><a href="#type-threshold" class="anchor"></a><code><span><span class="keyword">type</span> threshold</span><span> = <span>[ `All <span><span>| `Src</span> of string</span> ]</span> * <span><span class="xref-unresolved">Logs</span>.level option</span></span></code></div><div class="spec-doc"><p><code>threshold</code> type is used to control logging level and source.</p><p>The first element of the pair is a source pattern. It can be either <code>`All</code> (representing all the existing and new sources) or <code>`Src src</code>, representing the specific logging source named <code>src</code>.</p><p>The second element is the logging level. A log level of <code>None</code> indicates that logging is disabled for this source. If the level is <code>Some l</code> then any message whose level is smaller or equal to <code>l</code> is reported.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-env"><a href="#val-env" class="anchor"></a><code><span><span class="keyword">val</span> env : <span class="xref-unresolved">Cmdliner</span>.Cmd.Env.info</span></code></div><div class="spec-doc"><p><code>env</code> is the environment variable <code>LOGGING_LEVELS</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-levels"><a href="#val-levels" class="anchor"></a><code><span><span class="keyword">val</span> levels : 
  <span>?env:<span class="xref-unresolved">Cmdliner</span>.Cmd.Env.info <span class="arrow">&#45;&gt;</span></span>
  <span>?docs:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-threshold">threshold</a> list</span> <span class="xref-unresolved">Cmdliner</span>.Term.t</span></span></code></div><div class="spec-doc"><p><code>levels ~docs ~env ()</code> is a term that processes command-line arguments and environment variables to produce a list of thresholds for logging.</p><p><code>docs</code> is the title of the man page section in which the argument will be listed. <code>env</code> defines the name of an environment variable which is looked up for defining the argument if it is absent from the command line (default is <code>logging_levels_env</code>). See the description of <code>docs</code> and <code>env</code> in the <a href="https://erratique.ch/software/cmdliner/doc/Cmdliner/Arg/index.html#val-info">Cmdliner manual</a> for more details.</p><p>The option work as follow:</p><ul><li>The parameters is split into groups on ','</li><li>each group is turned into a threshold but splitting it on ':'</li><li>the expected logging levels are <code>&quot;app&quot;</code>, <code>&quot;error&quot;</code>, <code>&quot;warning&quot;</code>, <code>&quot;info&quot;</code> and <code>&quot;debug&quot;</code>. The are translated into the equivalent <code>Some d</code> value.</li><li>To disable a source, use <code>&quot;quiet&quot;</code> or <code>&quot;-&quot;</code> to get a <code>None</code> value.</li></ul><p>For instance, <code>--logging-level '*:info,foo:debug,bar:-'</code> is evaluated as follows.</p><ul><li><code>&quot;*:info&quot;</code> is <code>(`All, Some Logs.Info)</code>;</li><li><code>&quot;foo:debug&quot;</code> is <code>(`Src &quot;foo&quot;, Some Logs.debug)</code>; and</li><li><code>&quot;bar:-&quot;</code> is <code>(`Src &quot;bar&quot;, None)</code></li></ul><p>This means: use the default logging threshold <code>Logs.Info</code> for all sources, apart from the source <code>&quot;foo&quot;</code> that should use <code>Logs.Debug</code> and the source <code>&quot;bar&quot;</code> that should be disabled.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_levels"><a href="#val-set_levels" class="anchor"></a><code><span><span class="keyword">val</span> set_levels : <span>default:<span><span class="xref-unresolved">Logs</span>.level option</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-threshold">threshold</a> list</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_levels ~default l</code> configures the logging system to use all the log sources that appear in the threshold list <code>l</code>. If a log source is not present in <code>l</code>, then the default logging level is applied.</p><p>If the default level is <code>Some l</code> then any message sent to a source not in <code>l</code> and whose level is smaller or equal to <code>l</code> is reported. If the default level is <code>None</code> no message other than the ones in <code>l</code> are ever reported.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup"><a href="#val-setup" class="anchor"></a><code><span><span class="keyword">val</span> setup : <span>unit <span class="xref-unresolved">Cmdliner</span>.Term.t</span></span></code></div><div class="spec-doc"><p><code>setup</code> is a term that the init the logging system using <code>set_levels</code>. It parses the command-line arguments with <code>levels</code> and <code>Logs_cli</code>.setup_log.</p></div></div></div></body></html>